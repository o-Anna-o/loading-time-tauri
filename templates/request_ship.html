<html lang="en">
<head>
    <title>Расчёт времени погрузки контейнеров</title>
    <link rel="stylesheet" href="/styles/request_ship_style.css">
</head>
<body>
    <header>
        <h1>
            <a href="/ships"><img class="home-img header-icon" src="/img/home-img.svg" alt="home"></a>
        </h1>
    </header>

    <div class="request">
        <h1>Расчёт времени погрузки контейнеров</h1>  

        <form action="/request_ship/calculate_loading_time/{{.request_ship.RequestShipID}}" method="POST" class="request-form" id="main-form">
            <div class="request__counts">
                <div class="request__cnt request__cnt-20-f">
                    <p>Количество 20-футовых контейнеров</p>
                    <input class="request__cnt-input" type="number" name="containers_20ft" 
                        placeholder="Введите целое число" value="{{.request_ship.Containers20ftCount}}">
                </div>
                <div class="request__cnt request__cnt-40-f">
                    <p>Количество 40-футовых контейнеров</p>
                    <input class="request__cnt-input" type="number" name="containers_40ft" 
                        placeholder="Введите целое число" value="{{.request_ship.Containers40ftCount}}">
                </div>
            </div>

            <div class="fields">
                <div class="fields_item fields__comment">
                    <p>Комментарий</p>
                    <input class="fields__comment--input" type="text" name="comment" value="{{.request_ship.Comment}}"> 
                </div>
                <div class="fields_item fields__result">
                    <p>Общее время погрузки</p>
                    <input class="fields__result--input" type="text" value="{{.request_ship.LoadingTime}}" readonly> 
                </div>
            </div>
        </form>

        <h2>Выбранные контейнеровозы</h2>
        <div class="request__cards">
            {{ if .request_ship.Ships }}
                {{ range .request_ship.Ships }}
                <div class="request__card">
                    <h2 class="request__card__title">{{ .Ship.Name }}</h2>
                    <img class="request__card__ship-card__img" src="http://localhost:9000/loading-time-img/img/{{.Ship.PhotoURL}}" 
                         alt="{{.Ship.Name}}" onerror="this.style.display='none'">

                    <div class="ship-card__text">
                        <p><b>Вместимость:</b> {{ .Ship.Capacity }} TEU</p>
                        <p><b>Габариты:</b> длина {{ .Ship.Length }} м, ширина {{ .Ship.Width }} м</p>
                        <p><b>Краны:</b> {{ .Ship.Cranes }} одновременно</p>
                    </div>

                    <div class="ship-card__other">
                        <form action="/api/request_ship/{{$.request_ship.RequestShipID}}/ships/{{.Ship.ShipID}}" method="POST" class="ship-card__btn-form">
                            <input type="hidden" name="_method" value="DELETE">
                            <button type="submit" class="ship-card__other-item ship-card__other-btn btn">Удалить</button>
                        </form>

                        <div class="ship-card__other-item ship-card__cnt">
                            <p>Количество</p>
                            <input class="ship-card__cnt-input" type="text" value="{{.ShipsCount}}" readonly>
                        </div>
                    </div>
                </div>
                {{ end }}
            {{ else }}
                <div class="empty-message">
                    <p>Нет выбранных контейнеровозов. Добавьте контейнеровоз для расчета.</p>
                </div>
            {{ end }}
        </div>

        <div class="ship-card__btns">
            
            <button type="submit" form="main-form" class="ship-card__btn beige-btn btn">
                Рассчитать время погрузки
            </button>

            <form action="/api/request_ship/{{.request_ship.RequestShipID}}" method="POST" class="ship-card__btn-form">
                <input type="hidden" name="_method" value="DELETE">
                <button type="submit" class="ship-card__btn beige-btn btn">Удалить всю заявку</button>
            </form>
        </div>
    </div>
</body>
</html>